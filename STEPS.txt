Постановка задачи и метрик.
Определил цель прототипа: быстрый аналитический дашборд продаж (Excel + SQLite) и набор SQL-отчётов. Зафиксировал ключевые метрики: Total Revenue, Total Profit, Avg Check, Margin %, ТОП-товары/категории/менеджеры, динамика по месяцам.

Данные (откуда взялись).
Собрал исходные выгрузки из учётной системы/CRM (заказы, товары, категории, города, менеджеры) за период 2023 г. Для прототипа, чтобы не использовать реальные суммы/клиентов, обезличил и частично синтетически дополнил выборку в Python (генерация по тем же полям, чтобы не нарушать логику отчётности).

Структура проекта.
Организовал папки:
/data_raw — исходные CSV; /excel — рабочая книга; /sql — скрипты загрузки и запросов; /out — итоговые витрины (curated CSV).

Подключение Power Query (Excel 2019).
В Excel → Power Query подключил источник «Из папки» к /data_raw, объединил файлы, сформировал общий набор данных.

Очистка и нормализация в Power Query.
Привёл типы столбцов; нормализовал скидку (процент → десятичная доля); добавил вычисляемые поля:
Revenue = Qty * UnitPrice * (1 - Discount);
Profit = Revenue - Cost (или через маржу, если Cost отсутствует — по заданной нормативной наценке).
Убрал лишние пробелы/регистры, стандартизовал категории, пустых менеджеров заменил на «Unknown».

Модель данных (витрины).
Разбил на факт и измерения: FactSales, DimDate (календарь: год/квартал/месяц), DimCity, DimManager, DimCategory. Часть таблиц — через Reference в PQ, чтобы не дублировать логику.

Экспорт curated-данных.
Выгрузил очищенные таблицы в /out: sales_curated.csv и dim_*.csv (UTF-8, разделитель запятая).

Инициализация SQLite.
Создал БД sales_xl2019.db. Подготовил load.sql: DDL для таблиц (в т.ч. индексы), временные staging-таблицы для «чистой» загрузки, далее вставка в итоговые таблицы с INSERT OR IGNORE/де-дубликацией.

Загрузка данных.
Загрузил dim_* и sales_curated через .import (CLI sqlite3) → перенёс из staging в боевые таблицы, проверил типы и ключи.

Запросы и отчёты в SQL.
Написал queries.sql:

помесячная выручка/прибыль (CTE + группировки),

ТОП-10 товаров,

прибыль по менеджерам/категориям/городам,

ABC-анализ (доли в обороте).
Проверил, что агрегаты из SQL совпадают с расчётами в Excel.

Дашборд в Excel.
Собрал сводные таблицы и диаграммы: динамика по месяцам, прибыль по категориям, ТОП-товары, разрез по менеджерам. Добавил срезы (Год/Категория/Город/Сегмент). Отдельный лист KPI с Total Revenue, Total Profit, Avg Check, Margin %.

Оформление и UX.
Единые числовые форматы, понятные подписи, цвета, выравнивание, интерактивные срезы подключены ко всем сводным. Добавил «Обновлено: <дата>».

Контроль качества.
Сверил тоталы и выборочные группировки между Excel и SQLite; проверил отсутствия дублей в измерениях; убедился, что фильтры/срезы не «ломают» показатели.

Альтернативная проверка БД (по необходимости).
Просмотрел схему и содержимое через DB Browser for SQLite (визуально подтвердил связи и колонки).

Документация и воспроизводимость.
Описал в README порядок запуска: где лежат сырые и curated CSV, как выполнить load.sql/queries.sql, какие метрики на дашборде, какие предположения по данным (обезличивание/синтетика).